{{ if .isMac -}}
# Homebrew completion (macOS)
if command -v brew >/dev/null 2>&1; then
    eval "$(brew shellenv)"
    if [[ -r "$(brew --prefix)/etc/profile.d/bash_completion.sh" ]]; then
        source "$(brew --prefix)/etc/profile.d/bash_completion.sh"
    fi
fi
{{- end }}

export PATH="{{ .binDirAbs }}:$PATH"
export VISUAL=nvim

# Initialize starship prompt
if command -v starship >/dev/null 2>&1; then
    eval "$(starship init bash)"
fi

# Initialize tools
if command -v mise >/dev/null 2>&1; then
    eval "$(mise activate bash --shims)"
fi

if command -v zoxide >/dev/null 2>&1; then
    eval "$(zoxide init bash)"
fi

if command -v mcfly >/dev/null 2>&1; then
    eval "$(mcfly init bash)"
fi

[[ "$TERM_PROGRAM" == "vscode" ]] && . "$(code --locate-shell-integration-path bash)"

fzkill() {
    ps -eo pid,args,%mem,%cpu | fzf --multi --header-lines=1 | awk '{print $1}' | xargs kill "$@"
}

update-system() {
    bash "$(chezmoi source-path)/../update.sh"
}

# History settings
HISTFILE=~/.bash_history
HISTSIZE=20000
HISTFILESIZE=20000
HISTCONTROL=ignoreboth:erasedups
shopt -s histappend
shopt -s cmdhist
