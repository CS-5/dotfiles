#!/bin/bash

if infocmp xterm-ghostty >/dev/null 2>&1; then
    echo "Ghostty terminfo already installed, skipping"
    exit 0
fi

if ! command -v tic >/dev/null 2>&1; then
    echo "tic not found, skipping Ghostty terminfo install"
    exit 0
fi

TERMINFO_URL="https://raw.githubusercontent.com/ghostty-org/ghostty/main/src/terminfo/ghostty.terminfo"

if command -v curl >/dev/null 2>&1; then
    terminfo=$(curl -fsSL "$TERMINFO_URL")
elif command -v wget >/dev/null 2>&1; then
    terminfo=$(wget -qO- "$TERMINFO_URL")
else
    echo "Neither curl nor wget found, skipping Ghostty terminfo install"
    exit 0
fi

if [ -z "$terminfo" ]; then
    echo "Failed to download Ghostty terminfo"
    exit 0
fi

echo "$terminfo" | tic -x -
echo "Ghostty terminfo installed successfully"
