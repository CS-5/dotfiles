{{ if eq .osid "linux-debian" "linux-ubuntu" -}}

{{ $sudo := "sudo" -}}
{{ if eq .chezmoi.username "root" -}}
{{   $sudo = "" -}}
{{ end -}}

#!{{ lookPath "bash" }}

set -eufo pipefail

echo 'deb [signed-by=/usr/share/keyrings/azlux.gpg] https://packages.azlux.fr/debian/ bookworm main' | {{ $sudo }} tee /etc/apt/sources.list.d/azlux.list
{{ $sudo }} apt install gpg
curl -s https://azlux.fr/repo.gpg.key | gpg --dearmor | {{ $sudo }} tee /usr/share/keyrings/azlux.gpg > /dev/null
{{ $sudo }} apt update
{{ $sudo }} apt install gping

{{ if eq .osid "linux-debian" -}}
# Ubuntu version installed with .chezmoiexternal
{{ $sudo }} apt install lsd
{{ end -}}

curl -sSfL https://raw.githubusercontent.com/ajeetdsouza/zoxide/main/install.sh | sh -s -- --bin-dir {{ joinPath "~" .binDir }}
curl -sSfL https://raw.githubusercontent.com/cantino/mcfly/master/ci/install.sh | sh -s -- --git cantino/mcfly --to {{ joinPath "~" .binDir }}

{{ end -}}